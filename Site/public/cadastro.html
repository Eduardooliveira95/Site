<!DOCTYPE html>
<!-- <html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>AcquaTec | Cadastro</title>


    <script src="./js/funcoes.js"></script>


    <link rel="icon" href="./assets/icon/favicon.ico">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="header">
        <div class="container">
            <h1 class="titulo">AcquaTec</h1>
            <ul class="navbar">
                <li>
                    <a href="./index.html">
                        Inicial
                    </a>
                </li>
                <li>
                    <a href="./simulador.html">Simulador</a>
                </li>
                <li>|</li>
                <li>
                    <a href="./login.html">Login</a>
                </li>
                <li class="agora">
                    <a href="./cadastro.html">Cadastro</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="banner ">
        <div class="alerta_erro">
            <div class="card_erro" id="cardErro">
                <span id="mensagem_erro"></span>
            </div>
        </div>
        <div class="container tamanho-conteudo">
            <div class="card medio">
                <h2>Bem-vindo!</h2>
                <div class="formulario">
                    <span class="tipo_campo">Nome:</span>
                    <input id="nome_input" type="text" placeholder="Seu nome">

                    <span class="tipo_campo">E-mail:</span>
                    <input id="email_input" type="text" placeholder="meuemail@provedor.com">

                    <span class="tipo_campo">Senha:</span>
                    <input id="senha_input" type="password" placeholder="******">

                    <span class="tipo_campo">Confirmação da Senha:</span>
                    <input id="confirmacao_senha_input" type="password" placeholder="******">

                    <button class="btn" onclick="cadastrar()">Cadastrar</button>

                </div>
                <div id="div_aguardar" class="loading-div">
                    <img src="./assets/circle-loading.gif" id="loading-gif">
                </div>

                <div id="div_erros_login">

                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="container">
            <h4>Feito com amor por um aluno &hearts;SPTech &copy; 2022</h4>
        </div>
    </div>
</body>
-->


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word | Kart</title>
    <script src="./js/funcoes.js"></script>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="icon" href="../img/logo__kart4.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/body.css">
    <link rel="stylesheet" href="./css/root__index.css">
    <link rel="stylesheet" href="./css/cabecalho.css">
    <link rel="stylesheet" href="./css/meio__index.css">
    <link rel="stylesheet" href="./css/carrossel.css">
    <link rel="stylesheet" href="./css/rodape__index.css">
</head>
<body>
    <header class="cabecalho">
        <ul class="cabecalho__links">
            <img src="./assets/imgs/logo__kart4.svg" alt="" class="cabecalho__logo">
            <!-- <li class="cabecalho__letras"><a href="#">Início
                <section class="barra__cabecalho"></section></a>
            </li> -->
            <li class="cabecalho__letras"><a href="#meioTitulo">História
                <section class="barra__cabecalho"></section></a>
            </li>
            <li class="cabecalho__letras"><a href="#cadastro">Cadastro
                <section class="barra__cabecalho"></section></a>
            </li>
            <li class="cabecalho__letras"><a href="#votacao">Votação
                <section class="barra__cabecalho"></section></a>
            </li>
        </ul>
    </header>
    <main class="meio">
        <section class="banner">
            <p class="frase__efeito">Não é apenas uma corrida...</p>
        </section>
        <button id="voltarAoTopo" class="botao__voltar--topo">Voltar ao topo</button>
        <div id="items-wrapper">
            <div id="items">
                <div class="item"><img src="./assets/imgs/card1.png" alt="">
                    <p class="frase__efeito--corrida1">Momentos difíceis</p>
                </div>
                <div class="item"><img src="./assets/imgs/treino.jpg" alt="">
                    <p class="frase__efeito--corrida2">Treinos intensos</p>
                </div>
                <div class="item"><img src="./assets/imgs/batalha.jpg" alt="">
                    <p class="frase__efeito--corrida3">Batalhas Árduas</p>
                </div>
                <div class="item"><img src="./assets/imgs/BANNER5.png" alt="">
                    <p class="frase__efeito--corrida4">Uma conquista inesquecível</p>
                </div>
            </div>
        </div>

        <section class="meio__video">

            <p class="sub__video">Volta Rápida com um piloto Profissional...</p>

            <iframe width="760" height="515" src="https://www.youtube.com/embed/3ntlCKV9BjU" title="YouTube video player" 
            frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; 
            gyroscope; picture-in-picture" allowfullscreen></iframe>
        </section>

        <section class="meio__história">
            <h1 class="meio__titulo" id="meioTitulo">História do Kart</h1>
            <p class="meio__texto"> O kart surgiu em meados dos anos 50 após a Segunda Guerra mundial nos Estados Unidos. 
                Pilotos de aviões estavam cansados de fazer as mesmas coisas todos os dias e então 
                por isso decidiram criar uma atividade diferente para os momentos de folga.
                <p class="meio__texto">Art Ingels, também chamado de  “Pai do Kart”, os primeiros carros de corrida 
                Kurt Kraft com motores de aparadores de grama, e seu amigo Lou Borelli, não saiu do seu lado, 
                o ajudando em tudo o que era necessário.</p> 
                <p class="meio__texto">Como o kart era visto somente como um “brinquedo”, então Duffy Livingstone que era próximo
                a Art e Lou, teve a idéia de construir mais dois carros, um para ele e um para outro amigo. 
                Os quatro começaram a se encontrar e fazer pequenas competições entre eles, e foi assim 
                que tudo começou.</p>         
                <p class="meio__texto">Durante um bom tempo, o brinquedo era visto somente como algo amador e bem caseiro, 
                geralmente eram construídos por seus próprios donos e pilotos. Parece até engraçado, 
                mas naquela época, era bem comum a venda de kits munidos de instruções e ferramentas 
                para que o piloto pudesse construir seu próprio carro de kart.</p>  
                <p class="meio__texto">Depois de algum tempo, o espírito competitivo acertou a todos, a maioria dos homens queria 
                ter carro para competir, independente de sua idade. Foi por esse motivo que após essa década, 
                surgiram os primeiros fabricantes de kart.</p>                 
                <p class="meio__texto">Foi no kart que muitos grandes pilotos da Fórmula 1 começaram sua jornada, 
                como o Michael Schumacher, Nelson Piquet e o incrível Ayrton Senna. </p>
                <p class="meio__texto">Como a idade mínima para praticar kart é somente 6 anos, muitos pilotos começam e se 
                    apaixonam ainda pequenos por tudo o que envolve adrenalina e velocidade.<br><br>Fontes: https://sidspecialstore.com.br/historia-do-kart-e-suas-maiores-curiosidades/</p></p>
        </section>
        <section class="meio__cadastro" id="cadastro">
            <section class="meio__imagem--fundo--cadastro">
                <section class="meio__cadastro--input" id="menu__meio">
                    <p class="titulo__meio">Menu</p>
                    <button onclick="cadastrar1()" class="botao__cadastro--meio">Cadastrar</button>
                    <!-- <button onclick="login()" class="botao__cadastro--meio">Logar</button> -->
                    <button onclick="voltar()" class="botao__login--meio" id="botao__voltar">Voltar</button>
                </section>
                <section class="meio__cadastro--input" id="cadastro__meioo" style="display: none;">
                    <p class="titulo__cadastro">Fique por dentro das novidades! </p>
                    <p class="titulo__input--meio">Nome:</p>
                    <input class="inputs__cadastro--meio" type="text" id="nome_input">
                    <p  class="titulo__input--meio">Email:</p>
                    <input class="inputs__cadastro--meio" type="text" id="email_input">
                    <p  class="titulo__input--meio">Senha:</p>
                    <input class="inputs__cadastro--meio" type="text" id="senha_input">
                    <p  class="titulo__input--meio">Pista:</p>
                    <input class="inputs__cadastro--meio" type="text" id="pista_input">
                    <p  class="titulo__input--meio">Motor:</p>
                    <input class="inputs__cadastro--meio" type="text" id="motor_input">
                    <p  class="titulo__input--meio">Chassi:</p>
                    <input class="inputs__cadastro--meio" type="text" id="chassi_input">
                    <button class="botao__cadastro--meio" onclick="cadastrar()">Cadastrar</button>
                    <button onclick="voltar()" class="botao__cadastro--meio">Voltar</button>
                </section>


                <section id="cardErro" style="display: block;">
                    <section id="mensagem_erro"></section>
                </section>
                <section id="div_aguardar"></section>


                <section class="meio__cadastro--input" id="login__meio" style="display: none;">
                    <p  class="titulo__input--meio">Email:</p>
                    <input class="inputs__cadastro--meio" type="text" id="">
                    <p  class="titulo__input--meio">Senha:</p>
                    <input class="inputs__cadastro--meio" type="text" id="">
                    <button class="botao__cadastro--meio">Logar</button>
                    <button onclick="voltar()" class="botao__cadastro--meio">Voltar</button>
                </section>
            </section>
        </section>
        <section class="resultado" id="votacao">
            <!-- <p class="titulo__resultado">Resultado da Pesquisa</p> -->
            <section class="meio__resultado">

                <p class="subTitulo__resultado">Qual Chassi você mais gosta ?</p>
                <section class="sec__chassi">

                    <section class="div__check">
                        <p class="nomeCheck">CRG</p>
                        <label for="ipt_crg"><img src="./assets/imgs/crg.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_crg"> -->
                        <p class="check" id="ipt_crg"></p>
                    </section>
                    
                    <section class="div__check">
                        <p class="nomeCheck">Tony Kart</p>
                        <label for="ipt_tonyKart"><img src="./assets/imgs/tonyKart.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_tonyKart"> -->
                        <p class="check" id="ipt_tonyKart"></p>
                    </section>
                    
                    <section class="div__check">
                        <p class="nomeCheck">TechSpeed</p>
                        <label for="ipt_techSpeed"><img src="./assets/imgs/techspeed.jpg.opdownload" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_techSpeed"> -->
                        <p class="check" id="ipt_techSpeed"></p>
                    </section>

                </section>

                    <p class="subTitulo__resultado">Qual motor você mais gosta ?</p>
                    <section class="sec__motor">

                    <section class="div__check">
                        <p class="nomeCheck">Iame</p>
                        <label for="ipt_iame"><img src="./assets/imgs/iame.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="text" id="ipt_iame"> -->
                        <p class="check"id="ipt_iame"></p>
                    </section>
                    
                    <section class="div__check">
                        <p class="nomeCheck">TMKZ10</p>
                        <label for="ipt_tmKz10"><img src="./assets/imgs/tmKz10.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_tmKz10"> -->
                        <p class="check" id="ipt_tmKz10"></p>
                    </section>


                    <section class="div__check">
                        <p class="nomeCheck">Rotax</p>
                        <label for="ipt_rotax"><img src="./assets/imgs/rotaxKart.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_rotax"> -->
                        <p class="check" id="ipt_rotax"></p>
                    </section>

                </section>

                <p class="subTitulo__resultado">Qual destas pistas você mais gosta ?</p>
                <section class="sec__pista">


                    <section class="div__check">
                        <p class="nomeCheck">Aldeia da Serra</p>
                        <label for="ipt_Aldeia"><img src="./assets/imgs/aldeiaDaSerra.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_Aldeia"> -->
                        <p class="check" id="ipt_Aldeia"></p>
                    </section>
                    
                    <section class="div__check">
                        <p class="nomeCheck">Interlagos</p>
                        <label for="ipt_Interlagos"><img src="./assets/imgs/interlagos.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_Interlagos"> -->
                        <p class="check" id="ipt_Interlagos"></p>
                    </section>
                    
                    <section class="div__check">
                        <p class="nomeCheck">Granja Viana</p>
                        <label for="ipt_Granja"><img src="./assets/imgs/granjaViana.jpg" alt="" class="img__resultado"></label>
                        <!-- <input class="check" type="checkbox" id="ipt_Granja"> -->
                        <p class="check" id="ipt_Granja"></p>
                    </section>
                
                </section>


                <section class="bot__confirm">
                    <button class="botao__check" onclick="func_confirmarVoto()">Confirmar Voto</button>
                    <button class="botao__check" onclick="vot()">Mostrar votos</button>
                </section>
                <section id="mostrar__msg" style="display: none;">
                    <span id="mensagem"></span>
                </section>
            </section>
        </section>
    </main>
    <footer class="rodape">
        <img src="./assets/imgs/logo__kart4.svg" alt="" class="rodape__logo">
        <p>Eduardo</p>
        <p>@copy São Paulo Tech School 2022</p>
    </footer>
    <script src="./js/botoes.js"></script>
    <script src="./js/carrossel.js"></script>



</html> 


<script>

    var retorno = [];

    var vt_votos = []
    var vt_chassiCRG = []
    var vt_chassiTonyKart = []
    var vt_chassiTechSpeed = []
    var vt_motorIame = []
    var vt_motorTMKZ10 = []
    var vt_motorRotax = []
    var vt_pistaAldeia = []
    var vt_pistaInterlagos = []
    var vt_pistaGranja = []

    function func_confirmarVoto() {

        vt_votos.push(1)

        if (ipt_crg.checked === true) {
            vt_chassiCRG.push(1)
        }
        if (ipt_tonyKart.checked === true) {
            vt_chassiTonyKart.push(1)
        }
        if (ipt_techSpeed.checked === true) {
            vt_chassiTechSpeed.push(1)
        }
        if (ipt_iame.checked === true) {
            vt_motorIame.push(1)
        }
        if (ipt_tmKz10.checked === true) {
            vt_motorTMKZ10.push(1)   
        }
        if (ipt_rotax.checked === true) {
            vt_motorRotax.push(1)
        }
        if (ipt_Aldeia.checked === true) {
            vt_pistaAldeia.push(1)
        }
        if (ipt_Interlagos.checked === true) {
            vt_pistaInterlagos.push(1)
        }
        if (ipt_Granja.checked === true) {
            vt_pistaGranja.push(1)
        }
    }

    function func_mostrarVotos() {
        mostrar__msg.style.display = 'flex';
        mensagem.innerHTML = (
            `Quantidade de votos: ${vt_votos.length} <br> <br>
        Chassi CRG: ${vt_chassiCRG.length} <br> <br>
        Chassi TonyKart: ${vt_chassiTonyKart.length} <br> <br>
        Chassi TechSpeed: ${vt_chassiTechSpeed.length} <br> <br>
        Motor Iame: ${vt_motorIame.length} <br> <br>
        Motor TmKz10: ${vt_motorTMKZ10.length} <br> <br>
        Motor Rotax: ${vt_motorRotax.length} <br> <br>
        Pista Aldeia: ${vt_pistaAldeia.length}  <br> <br>
        Pista Interlagos: ${vt_pistaInterlagos.length}  <br> <br>
        Pista Granja: ${vt_pistaGranja.length}  <br> <br>
        `)
    }
</script>






<script>
    function cadastrar() {
        // aguardar();

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var nomeVar = nome_input.value;
        var emailVar = email_input.value;
        var senhaVar = senha_input.value;
        var pistaVar = pista_input.value;
        var motorVar = motor_input.value;
        var chassiVar = chassi_input.value;
        // var confirmacaoSenhaVar = confirmacao_senha_input.value;

        if (nomeVar == "" || emailVar == "" || senhaVar == "" || pistaVar == "" || motorVar == "" || chassiVar == "") {
            cardErro.style.display = "block"
            alert(`Todos os campos em branco)`)

            if (nomeVar == "") {
            mensagem_erro.innerHTML = "<span class ='msg__validação'>Nome está em branco</span>"
            }else
            if (emailVar == "") {
            mensagem_erro.innerHTML = "<span class ='msg__validação'>Email está em branco</span>"
            }else
            if (senhaVar == "") {
            mensagem_erro.innerHTML = "<span class ='msg__validação'>Senha está em branco</span>"
            }else

            if (senhaVar != confirmarSenhaVar) {
            mensagem_erro.innerHTML = "A senha não confere"
            }

        finalizarAguardar();
        return false;
    }
        if (emailVar.indexOf("@") == -1, emailVar.indexOf("email") == -1, emailVar.indexOf(".com") == -1 ) {
            window.alert("E-mail inválido! Verifique e tente novamente.");
            finalizarAguardar();
            return false;
        }

        if (senhaVar.length <= 3 || senhaVar.length >= 40) {
            mensagem_erro.innerHTML = "A Senha deve ter no mínimo 4 caracteres."
            finalizarAguardar();
            return false;
        }

        // else {
        //     setInterval(sumirMensagem, 5000)
        // }



        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar,
                pistaServer: pistaVar,
                motorServer: motorVar,
                chassiServer: chassiVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                cardErro.style.display = "block";

                mensagem_erro.innerHTML = "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

                setTimeout(() => {
                    window.location = "cadastro.html";
                }, "2000")
                
                limparFormulario();
                finalizarAguardar();
            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            finalizarAguardar();    
        });

        return false;
    }

    // function sumirMensagem() {
    //     cardErro.style.display = "none"
    // }




// --------------------------- Métricas ----------------------------



    function vot() {
        fetch("/usuarios/listar", {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO listar()!")

            if (resposta.ok) {
                console.log(resposta);
                resposta.json().then(json => {
                    retorno = [];
                    
                    for(let i = 0; i < json.length; i ++ ){
                        retorno.push(json[i]);
                        console.log(retorno[i])
                    }
                    //função vai aqui!!!!!!!!!!!!!!!!!
                    separacao();
                });
            } else {
                console.log("Houve um erro ao tentar realizar o listar!");
                resposta.text().then(texto => {
                    console.error(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }


    //  FUNÇÃOOOOO!!!!!!! AQUI VAI O INNERHTML

    function separacao() {
        for (let index = 0; index < retorno.length; index++) {
            console.log(index);
            if (retorno[index].pista == 'Aldeia da Serra') {
                vt_pistaAldeia.push(retorno[index].pista);
                ipt_Aldeia.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_pistaAldeia.length}</span>`;
            } else if (retorno[index].pista == 'Interlagos') {
                vt_pistaInterlagos.push(retorno[index].pista);
                ipt_Interlagos.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_pistaInterlagos.length}</span>`;
            } else if (retorno[index].pista == 'Granja Viana') {
                vt_pistaGranja.push(retorno[index].pista);
                ipt_Granja.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_pistaGranja.length}</span>`;
            }


            if (retorno[index].motor == 'Iame') {
                vt_motorIame.push(retorno[index].motor);
                ipt_iame.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_motorIame.length}</span>`;
            } else if (retorno[index].motor == 'TMKZ10') {
                vt_motorTMKZ10.push(retorno[index].motor);
                ipt_tmKz10.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_motorTMKZ10.length}</span>`;
            } else if (retorno[index].motor == 'Rotax') {
                vt_motorRotax.push(retorno[index].motor);
                ipt_rotax.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_motorRotax.length}<span>`;
            }
        
            if (retorno[index].chassi == 'CRG') {
                vt_chassiCRG.push(retorno[index].chassi);
                ipt_crg.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_chassiCRG.length}</span>`;
            } else if (retorno[index].chassi == 'TonyKart') {
                vt_chassiTonyKart.push(retorno[index].chassi);
                ipt_tonyKart.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_chassiTonyKart.length}</span>`;
            } else if (retorno[index].chassi == 'TechSpeed') {
                vt_chassiTechSpeed.push(retorno[index].chassi);
                ipt_techSpeed.innerHTML = `<span style="font-size: 25px;"> Votos: ${vt_chassiTechSpeed.length}</span>`;
            }
        }
    }
    
</script>


<script>


    function entrar() {
        aguardar();

        var emailVar = email_input.value;
        var senhaVar = senha_input.value;

        if (emailVar == "" || senhaVar == "") {
            cardErro.style.display = "block"
            mensagem_erro.innerHTML = "(Mensagem de erro para todos os campos em branco)";
            finalizarAguardar();
            return false;
        }
        else {
            setInterval(sumirMensagem, 5000)
        }

        console.log("FORM LOGIN: ", emailVar);
        console.log("FORM SENHA: ", senhaVar);

        fetch("/usuarios/autenticar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                emailServer: emailVar,
                senhaServer: senhaVar
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));

                    sessionStorage.EMAIL_USUARIO = json.email;
                    sessionStorage.NOME_USUARIO = json.nome;
                    sessionStorage.ID_USUARIO = json.id;

                    setTimeout(function () {
                        window.location = "./dashboard/cards.html";
                    }, 1000); // apenas para exibir o loading

                });

            } else {

                console.log("Houve um erro ao tentar realizar o login!");

                resposta.text().then(texto => {
                    console.error(texto);
                    finalizarAguardar(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }

    // function sumirMensagem() {
    //     cardErro.style.display = "none"
    // }

</script>
